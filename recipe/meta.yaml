{% set version = "9.1.21" %}

package:
  name: swi-prolog
  version: {{ version }}

source:
# url: https://www.swi-prolog.org/download/devel/src/swipl-{{ version }}.tar.gz
# sha256: 8536acab1892edb7db3fa46df439fc19158a8448341af98a33c6359b312ef705
  url: file:///home/janw/src/swipl-9.1.21.tar.gz
  sha256: f494187451901c947924ec34bc78ddeed35a86b00ef96f34f48ebf9f527b1ab7
# git_url: https://github.com/SWI-Prolog/swipl-devel.git
# git_rev: HEAD
# git_depth: 1

build:
  number: 16

requirements:
  build:
    - git
    - cmake
    - pkg-config	# [not win]
    - ninja		# [not win]
    - {{ compiler('c') }}
    - {{ compiler('cxx') }}

  host:
    - zlib
    - pthreads-win32	# [win]
    - gmp		# [not (osx or win)]
    - gperftools	# [not (osx or win)]
    - python
    - pip
    - setuptools
    - setuptools-scm
    - wheel
    - build
    - libedit		# [not win]
    - readline		# [not win]
    - openssl
    - unixodbc		# [not win]
    - libarchive
    - pcre2
    - yaml
    - ossuuid		# [not (osx or win)]
    - libdb		# [not osx]
    - openjdk
    - python		# [not win]
    - fontconfig	# [not win]
    - xorg-libice	# [not win]
    - xorg-libsm	# [not win]
    - xorg-libx11	# [not win]
    - xorg-libxaw	# [not win]
    - xorg-libxext	# [not win]
    - xorg-libxinerama	# [not win]
    - xorg-libxmu	# [not win]
    - xorg-libxpm	# [not win]
    - xorg-libxrender	# [not win]
    - xorg-libxt	# [not win]
    - xorg-libxft	# [not (osx or win)]
    - libjpeg-turbo

  run:
    - python
    - setuptools
    - openjdk
    - pthreads-win32    # [win]

outputs:
  - name: swi-prolog-core
    script: install-core.py
    requirements:
      build:
        - cmake
      run:
        - zlib
        - pthreads-win32	# [win]
        - gperftools		# [not (osx or win)]
        - gmp			# [not (osx or win)]
        - ossuuid		# [not (osx or win)]
  - name: swi-prolog-gui
    script: install-gui.py
    requirements:
      build:
        - cmake
      run:
        - swi-prolog-core
        - fontconfig		# [not win]
        - xorg-libice		# [not win]
        - xorg-libsm		# [not win]
        - xorg-libx11		# [not win]
        - xorg-libxaw		# [not win]
        - xorg-libxext		# [not win]
        - xorg-libxinerama	# [not win]
        - xorg-libxmu		# [not win]
        - xorg-libxpm		# [not win]
        - xorg-libxrender	# [not win]
        - xorg-libxt		# [not win]
        - xorg-libxft		# [not (osx or win)]
        - libjpeg-turbo
  - name: swi-prolog-python
    script: install-python.py
    requirements:
      build:
        - cmake
        - python
      run:
        - swi-prolog-core
        - python
  - name: swi-prolog-java
    script: install-java.py
    requirements:
      build:
        - cmake
      run:
        - swi-prolog-core
        - openjdk

test:

about:
  home: https://www.swi-prolog.org
  license: BSD-2
  license_family: BSD-Clause
  license_family: BSD
  license_file: LICENSE
  summary: A comprehensive Prolog implementation
  dev_url: https://github.com/SWI-Prolog/swipl-devel
  doc_url: https://www.swi-prolog.org/pldoc/doc_for?object=root
